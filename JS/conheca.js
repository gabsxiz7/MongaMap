//dados dos pontos tur√≠sticos
const pontosTuristicos = [
    {
        titulo: "Plataforma de Pesca",
        descricao: `
        <p>Fundada em 1979, a <strong>Plataforma de Pesca</strong> √© um dos principais pontos tur√≠sticos de Mongagu√°. Um lugar perfeito para pesca e lazer.
        A Plataforma de Pesca Amadora de Mongagu√°, localizada na Praia do Centro, √© um dos cart√µes-postais mais emblem√°ticos do munic√≠pio e um importante ponto tur√≠stico e cultural da regi√£o. Inaugurada em 1979, a estrutura foi projetada para ser uma das maiores plataformas de pesca da Am√©rica Latina, consolidando Mongagu√° como um destino atrativo para os amantes da pesca e do turismo.

        <p>Com uma extens√£o de 400 metros adentrando o mar e cerca de 6 metros de largura, a plataforma proporciona um ambiente ideal tanto para pescadores quanto para visitantes que buscam apreciar a vista panor√¢mica do oceano. Sua estrutura conta com ilumina√ß√£o adequada, permitindo a pr√°tica de pesca noturna, e oferece um espa√ßo seguro para o lazer e conviv√™ncia social.</p>

       <p>No entanto, ao longo dos anos, a plataforma enfrentou desafios relacionados √† sua conserva√ß√£o. Exposta constantemente √† a√ß√£o do tempo e das intemp√©ries mar√≠timas, passou por diversas reformas para garantir a seguran√ßa e a funcionalidade. Uma das reformas mais significativas foi realizada na d√©cada de 2010, quando a estrutura recebeu melhorias importantes para continuar atraindo pescadores e turistas.
       A plataforma tamb√©m √© um ponto estrat√©gico para a economia local, movimentando o turismo e o com√©rcio ao seu redor. Com a presen√ßa de pescadores amadores de diversas regi√µes, h√° uma valoriza√ß√£o das atividades pesqueiras tradicionais, al√©m de gerar oportunidades para os comerciantes locais, como vendedores de equipamentos de pesca, alimentos e bebidas.</p>


       <p>Al√©m da pesca, a plataforma √© um espa√ßo para contempla√ß√£o e conv√≠vio social, oferecendo uma experi√™ncia √∫nica de intera√ß√£o com o ambiente mar√≠timo. √â comum que moradores e turistas aproveitem o local para caminhadas, sess√µes de fotografia e momentos de relaxamento ao som das ondas do mar.
       Com sua relev√¢ncia hist√≥rica e cultural, a Plataforma de Pesca de Mongagu√° n√£o √© apenas um ponto tur√≠stico, mas tamb√©m um s√≠mbolo de identidade para a popula√ß√£o local, representando a rela√ß√£o intr√≠nseca da cidade com o mar e a pesca.</p>`,
    coords:[-24.134243, -46.692596]
    },

    {
        titulo: "Parque Ecol√≥gico",
        descricao: `
        <p>O <strong>Parque Ecol√≥gico</strong> "<em>A Tribuna</em>" √© uma importante √°rea de educa√ß√£o ambiental localizada em Mongagu√°, S√£o Paulo. Inaugurado em 1996, o parque ocupa uma √°rea de 15 mil metros quadrados e tem como principal objetivo conscientizar o p√∫blico sobre quest√µes ambientais, incluindo o tr√°fico de animais silvestres, reciclagem e conserva√ß√£o da biodiversidade.</p>

       <p>Entre suas atra√ß√µes, destacam-se recintos para jabutis, um serpent√°rio com cobras pe√ßonhentas e n√£o pe√ßonhentas, um viveiro interativo de aves, al√©m de espa√ßos que abrigam quatis, jacar√©s, tucanos e gavi√µes. O parque tamb√©m conta com 15 aqu√°rios que exibem peixes tropicais e marinhos de diversas partes do mundo. Adicionalmente, h√° um espa√ßo dedicado √† educa√ß√£o ambiental, com acervos de conchas, sementes, pedras e areias de todas as praias do litoral de S√£o Paulo, al√©m de animais conservados em formol.</p>

       <p>Em janeiro de 2023, ap√≥s mais de dois anos fechado para reformas, o parque foi reinaugurado. As melhorias inclu√≠ram a reconstru√ß√£o de pontes, recupera√ß√£o da vegeta√ß√£o, amplia√ß√£o das √°reas de passeio com pisos intertravados, revitaliza√ß√£o dos telhados dos pavilh√µes e aqu√°rio, reforma dos viveiros e instala√ß√£o de novos guarda-corpos. Novidades como um playground para crian√ßas, novos viveiros para aves, macacos-prego e coelhos, al√©m de um melipon√°rio com abelhas nativas sem ferr√£o da esp√©cie Jata√≠, foram incorporadas ao espa√ßo.</p>

       <p>O parque est√° localizado na Avenida Governador M√°rio Covas J√∫nior, 10.410, no bairro Agenor de Campos, e funciona de ter√ßa a domingo, das 9h √†s 17h, com venda de ingressos at√© as 16h.</p>
       <ul>
          <li><p>O ingresso custa R$ 8,00, com meia-entrada de R$ 4,00 para estudantes e idosos acima de 60 anos.</p></li> 
          <li><p>Crian√ßas at√© 7 anos e pessoas com defici√™ncia t√™m entrada gratuita.</p></li>
          </ul>`,
coords: [-24.134406, -46.695230]
    },
    {
        titulo:"Par√≥quia Nossa Senhora Aparecida",
        descricao:`
        <p>A <strong>Par√≥quia Nossa Senhora Aparecida</strong>, localizada no centro de Mongagu√°, S√£o Paulo, √© um marco hist√≥rico e religioso da cidade. Constru√≠da em 1949 em estilo colonial, a igreja abriga a imagem de Nossa Senhora da Concei√ß√£o Aparecida, trazida diretamente de Aparecida do Norte. Al√©m disso, possui imagens de santos como S√£o Jos√©, Santa Rita de C√°ssia, S√£o Judas Tadeu e Santa Luzia. Destacam-se tamb√©m os vitrais coloridos que retratam cenas b√≠blicas, como a "Anuncia√ß√£o", o "Nascimento de Jesus", o "Cristo Redentor" e "Jesus rezando no horto das oliveiras", al√©m de uma r√©plica da obra "Piet√†", de Michelangelo.</p>

        <p>Anualmente, no dia 12 de outubro, a cidade celebra o dia de Nossa Senhora Aparecida, padroeira do munic√≠pio, com uma encena√ß√£o no rio Mongagu√°, pr√≥ximo √† igreja, representando o momento em que a imagem da santa foi encontrada nas √°guas do rio Para√≠ba do Sul. 
        A igreja est√° situada na Avenida S√£o Paulo, 1679, no Centro de Mongagu√°, entre o rio Mongagu√° e uma pra√ßa com diversas esp√©cies de palmeiras e outras √°rvores nativas, tornando-se um ponto de refer√™ncia tanto para moradores quanto para visitantes.</p>`,
coords: [-24.094984, -46.620291]
    },
    {
        titulo:"Praia Fl√≥rida Mirim",
        descricao:`
        <p>A <strong>Praia Fl√≥rida Mirim</strong>, localizada no munic√≠pio de Mongagu√°, litoral sul de S√£o Paulo, destaca-se por sua tranquilidade e beleza natural. Urbanizada recentemente, a praia ainda preserva caracter√≠sticas de √°reas mais afastadas, com poucos quiosques e casas de veraneio, proporcionando um ambiente sereno, especialmente na baixa temporada.</p> 

       <p>A faixa de areia √© larga, composta por gr√£os grossos e compactados pela for√ßa do mar. As √°guas s√£o calmas, com ondas discretas, tornando-a ideal para banhos de mar e momentos de lazer em fam√≠lia.</p> 

       <p>Durante o ver√£o, o bairro pr√≥ximo √† praia organiza shows e feiras, oferecendo op√ß√µes de entretenimento aos visitantes. A presen√ßa de coqueiros ao longo do cal√ßad√£o adiciona um charme especial ao local, convidando para caminhadas e contempla√ß√£o da paisagem.</p>

       <p>A Praia Fl√≥rida Mirim √© uma excelente op√ß√£o para quem busca um ref√∫gio tranquilo, com menor movimenta√ß√£o tur√≠stica, permitindo maior contato com a natureza e momentos de relaxamento √† beira-mar.</p>`,
coords:[-24.132455, -46.711498]
    },
    {
        titulo:"Pra√ßa de Eventos Dudu Samba",
        descricao:`
        <p>A <strong>Pra√ßa de Eventos Dudu Samba</strong>, localizada em frente √† Praia do Centro de Mongagu√°, √© um espa√ßo multifuncional dedicado √† realiza√ß√£o de diversos eventos culturais e de entretenimento na cidade.</p> 

       <p>Ao longo dos anos, a pra√ßa tem sido palco de shows de artistas renomados, festivais e celebra√ß√µes sazonais, como o tradicional "Fest√£o na Praia", que ocorre anualmente durante o m√™s de julho.</p> 
    
       <p>Al√©m disso, em dezembro de 2024, a dupla sertaneja Thaeme e Thiago se apresentou na pra√ßa em comemora√ß√£o ao anivers√°rio de Mongagu√°, evidenciando a relev√¢ncia do espa√ßo para grandes eventos.</p>

       <p>A infraestrutura da pra√ßa inclui quiosques de alimenta√ß√£o, pista de skate e √°reas destinadas ao lazer, tornando-a um ponto de encontro para moradores e turistas.</p> 

       <p>Durante a alta temporada, especialmente nos meses de ver√£o, √© comum a instala√ß√£o de parques de divers√£o e feiras de artesanato, ampliando as op√ß√µes de entretenimento para os visitantes.</p> 


       <p>A <strong>Pra√ßa de Eventos Dudu Samba</strong> n√£o apenas dinamiza a vida cultural de Mongagu√°, mas tamb√©m contribui significativamente para a economia local, atraindo visitantes e fomentando o com√©rcio na regi√£o central da cidade.</p>`,
coords: [-24.09606, -46.62045]
    },
    {
        titulo:"Po√ßo das Antas",
        descricao:`
        <p>O <strong>Po√ßo das Antas</strong>, situado em Mongagu√°, S√£o Paulo, √© uma das principais atra√ß√µes tur√≠sticas da cidade, reconhecido por sua beleza natural e relev√¢ncia hist√≥rica. Localizado no Parque Tur√≠stico Umberto Salomone, entre a Serra do Mar e o centro de Mongagu√°, o local oferece uma combina√ß√£o √∫nica de cachoeiras, piscinas naturais e trilhas ecol√≥gicas. A origem do nome <em>"Po√ßo das Antas"</em> possui duas explica√ß√µes populares:</p>
       <ul>
         <li><p>Semelhan√ßa das pedras com antas: Ind√≠genas da regi√£o acreditavam que as pedras do local assemelhavam-se √†s cabe√ßas de antas.</p></li>
         <li><p>Presen√ßa de antas: As antas desciam da Serra do Mar para beber √°gua na piscina natural formada pela cachoeira.</p></li>
        </ul>
       <p>O parque foi revitalizado e reinaugurado em dezembro de 2023, visando melhorar a infraestrutura para os visitantes. Atualmente, o local conta com banheiros, pontes com corrim√£o, lanchonetes, guarita e amplo estacionamento, proporcionando conforto e seguran√ßa aos frequentadores.
       O Po√ßo das Antas √© ideal para banhos, piqueniques e caminhadas pelas trilhas que levam a outras cachoeiras na regi√£o. O parque funciona diariamente das 9h √†s 17h, com ingressos vendidos at√© as 16h. As taxas de entrada s√£o:</p>
       <ul>
         <li><strong>Ingresso</strong>: R$ 8,00</li>
         <li><p>Estudantes e idosos acima de 60 anos: R$ 4,00 (mediante comprova√ß√£o)</p></li>
         <li><p>Crian√ßas at√© 7 anos: entrada gratuita (com documenta√ß√£o comprobat√≥ria)</p></li>
         <li><p>Estacionamento para carros: R$ 10,00</p></li>
         <li><p>Estacionamento para motos: R$ 5,00</p></li>`,
coords: [-24.0935, -46.6225]
    },
    {
        titulo:"Feira de Artesanato do Centro",
        descricao:`
        <p>A <strong>Feira de Artesanato</strong> do Centro de Mongagu√° √© um ponto tur√≠stico significativo da cidade, destacando-se por sua arquitetura e variedade de produtos artesanais. Localizada na Rua Sete de Dezembro, pr√≥xima √† Pra√ßa Jacoub Koukdjian, a feira √© composta por 98 quiosques constru√≠dos em madeira maci√ßa e tijolos aparentes, conferindo ao espa√ßo um charme r√∫stico e acolhedor.</p> 

       <p>A feira funciona principalmente nos finais de semana e feriados, oferecendo aos visitantes uma ampla gama de produtos artesanais que refletem a cultura e as tradi√ß√µes locais. Al√©m das pe√ßas de artesanato, o espa√ßo conta com diversas op√ß√µes gastron√¥micas, proporcionando uma experi√™ncia completa para os frequentadores.</p>

       <p>Ao longo dos anos, a Feira de Artesanato do Centro de Mongagu√° tem se consolidado como um espa√ßo de valoriza√ß√£o da cultura local, permitindo que artes√£os exponham e comercializem seus trabalhos, al√©m de servir como ponto de encontro para moradores e turistas que buscam lazer e entretenimento na cidade.</p>`,
coords: [-24.09462, -46.61961]
    },
    {
        titulo:"Morro da Padroeira",
        descricao:`
        <p>O Morro da Padroeira, localizado no centro de Mongagu√°, S√£o Paulo, √© um dos principais pontos tur√≠sticos e religiosos da cidade. No topo do morro, destaca-se uma imponente est√°tua de Nossa Senhora Aparecida, padroeira do Brasil, com mais de 15 metros de altura e aproximadamente 2,5 toneladas. A imagem foi instalada em dezembro de 2006, ap√≥s cerca de dois meses de constru√ß√£o pela artista pl√°stica Eduarda Belchior.</p> 

       <p>Para acessar a est√°tua, os visitantes percorrem uma trilha urbana composta por uma passarela de madeira com 150 metros de extens√£o e 139 degraus, que atravessa uma √°rea de mata nativa. No percurso, √© poss√≠vel avistar p√°ssaros silvestres e, ao chegar ao deck situado a 30 metros acima do ch√£o, desfrutar de uma vista panor√¢mica deslumbrante da regi√£o, incluindo a Serra do Mar, o bairro Vila S√£o Paulo e a divisa com a cidade de Praia Grande.</p> 

      <p>Aos p√©s da est√°tua, encontra-se o Skate Park, um espa√ßo dedicado √† pr√°tica de esportes radicais, evidenciando a integra√ß√£o entre devo√ß√£o religiosa e atividades de lazer no local. 
      O Morro da Padroeira n√£o apenas simboliza a f√© dos moradores de Mongagu√°, mas tamb√©m representa um importante atrativo tur√≠stico, oferecendo uma combina√ß√£o √∫nica de espiritualidade, natureza e recrea√ß√£o.</p>`,
coords: [-24.0890, -46.6180]
    },
    {
        titulo: "Praia Agenor de Campos",
        descricao:`
        <p>A Praia de Agenor de Campos, localizada em Mongagu√°, S√£o Paulo, √© uma das praias mais movimentadas da cidade, situada no Complexo Plataforma, pr√≥ximo √† Plataforma Mar√≠tima de Pesca Amadora e ao Parque Ecol√≥gico Tur√≠stico "A Tribuna".</p>

       <p>A hist√≥ria da praia est√° intimamente ligada ao desenvolvimento do bairro de Agenor de Campos, que ganhou destaque tur√≠stico com a inaugura√ß√£o da Plataforma de Pesca em 10 de mar√ßo de 1979. Essa estrutura foi constru√≠da entre 1977 e 1979 pelo Governo do Estado de S√£o Paulo em parceria com a Federa√ß√£o Paulista de Pesca e Lan√ßamento (FPPL), com o objetivo de descentralizar o turismo que se concentrava no centro de Mongagu√°, atraindo visitantes para a regi√£o de Agenor de Campos.</p> 

      <p>A praia possui uma extens√£o de aproximadamente 2 km, com areia escura e compacta, ideal para caminhadas e pr√°tica de exerc√≠cios. O mar √© agitado, com ondas fortes, tornando-se um ponto atrativo para surfistas. A orla √© urbanizada, contando com quiosques, coqueiros e uma feira de artesanato, al√©m de uma est√°tua de Iemanj√°, inaugurada em 2005, que homenageia a Rainha do Mar e √© um local de venera√ß√£o das religi√µes africanas.</p> 

      <p>Durante a alta temporada, especialmente no ver√£o, a Praia de Agenor de Campos recebe diversos shows e eventos musicais, tornando-se um centro de entretenimento para moradores e turistas. A infraestrutura do bairro inclui pousadas, locais para camping e uma variedade de op√ß√µes gastron√¥micas, atendendo √†s necessidades dos visitantes.</p> 

      <p>A Praia de Agenor de Campos destaca-se n√£o apenas por suas belezas naturais, mas tamb√©m por sua relev√¢ncia hist√≥rica no desenvolvimento tur√≠stico de Mongagu√°, consolidando-se como um importante destino no litoral paulista.</p>`,
coords: [-24.13087, -46.68704]
    },
    {
        titulo: "Centro Cultural Raul Cortez",
        descricao:`
        <p>O Centro Cultural Raul Cortez, localizado em Mongagu√°, S√£o Paulo, foi inaugurado em dezembro de 1996, sendo o primeiro centro de cultura do Litoral Sul Paulista. Nomeado em homenagem ao renomado ator brasileiro Raul Cortez, o espa√ßo tornou-se o cora√ß√£o da cena cultural da cidade.</p>

       <p>O centro oferece uma variedade de cursos gratuitos para a popula√ß√£o, incluindo m√∫sica, pintura, teclado, viol√£o, violino, hip hop, ballet, jazz, dan√ßa de rua, dan√ßa do ventre, teatro, dan√ßa de sal√£o e coral.</p>

       <p>Al√©m disso, abriga o Teatro Municipal Ronaldo Ciambroni, com capacidade para 320 espectadores, onde s√£o realizados grandes espet√°culos teatrais, exposi√ß√µes de arte e outros eventos culturais.</p> 

       <p>Em novembro de 2024, foi lan√ßado o minidocument√°rio 'O Palco da Cultura de Mongagu√°. Uma viagem por dentro do Centro Cultural Raul Cortez', que retrata os bastidores da constru√ß√£o, in√≠cio das atividades e evolu√ß√£o do centro cultural. O document√°rio destaca a import√¢ncia do espa√ßo como um dos maiores polos de cultura da regi√£o, recebendo anualmente mais de 20 mil pessoas.</p> 

       <p>O Centro Cultural Raul Cortez continua a desempenhar um papel fundamental na promo√ß√£o e desenvolvimento das artes em Mongagu√°, oferecendo oportunidades de aprendizado e entretenimento para moradores e visitantes.</p>`,
coords: [-24.10203, -46.63637]
    }
];




// Vari√°veis globais para o mapa e QR Code scanner
let modalMap = null;
let qrScanner = null;

// Fun√ß√£o para adicionar o mapa ao modal
function adicionarMapa(coords, titulo) {
    const mapElement = document.getElementById("modal-map");

    // Remove o mapa anterior se j√° existir
    if (modalMap) {
        modalMap.remove();
        modalMap = null;
    }

    // Inicializa o mapa com as coordenadas fornecidas
    modalMap = L.map(mapElement).setView(coords, 15);

    // Adiciona o tile layer do OpenStreetMap
    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(modalMap);

    // Adiciona um marcador no local
    L.marker(coords).addTo(modalMap).bindPopup(titulo).openPopup();

    // Ajusta o tamanho do mapa ap√≥s o modal ser exibido
    setTimeout(() => {
        modalMap.invalidateSize();
    }, 300);
}

// Fun√ß√£o para abrir o modal com informa√ß√µes do ponto tur√≠stico
function abrirModal(index) {
    const ponto = pontosTuristicos[index];

    // Atualiza t√≠tulo e descri√ß√£o
    document.getElementById("modal-title").textContent = ponto.titulo;
    document.getElementById("modal-description").innerHTML = ponto.descricao;

    // Exibe o modal
    const modal = document.getElementById("modal");
    modal.style.display = "block";

    // Aguarda o modal estar vis√≠vel antes de inicializar o mapa e QR Code
    setTimeout(() => {
        if (ponto.coords) {
            adicionarMapa(ponto.coords, ponto.titulo);
        }

        // Inicia o scanner de QR Code corretamente
        iniciarLeitorQRCode();
    }, 500);
}

// Fun√ß√£o para iniciar o leitor de QR Code
function iniciarLeitorQRCode() {
    if (qrScanner) {
        qrScanner.clear();
        qrScanner = null;
    }
    qrScanner = new Html5QrcodeScanner("qr-reader", { fps: 10, qrbox: 250 });
    qrScanner.render(onScanSuccess, onScanError);
}


// Fun√ß√£o executada ao escanear um QR Code com sucesso
function onScanSuccess(decodedText) {
  // 1) descodifica qualquer url-encoded leftover
  let text = decodeURIComponent(decodedText.trim());
  let id = null;

  // 2) tenta extrair scan ou id via URL
  try {
    const url = new URL(text);
    id = url.searchParams.get('scan') || url.searchParams.get('id');
  } catch {
    // n√£o √© URL v√°lida ‚Äî cai no fallback abaixo
  }

  // 3) se ainda n√£o encontrou, tenta extrair o n√∫mero direto no texto
  if (!id) {
    const m = text.match(/(?:scan|id)=(\d+)/);
    if (m) id = m[1];
  }

  if (!id) {
    alert('‚ùå QR inv√°lido');
    return;
  }

  // 4) chama o endpoint
  fetch(`php/credita_pontos.php?id=${id}`)
    .then(r => r.json())
    .then(json => {
      if (json.sucesso) {
        alert(`üéâ +${json.pontosGanhos} pontos! Total: ${json.total}`);
        window.location.href = 'gamificacao.php?recompensa=1';
      } else {
        alert('‚ùå ' + (json.erro || 'Falha ao creditar'));
      }
    })
    .catch(() => alert('‚ùå Erro de rede'));
}


// Fun√ß√£o executada se houver erro na leitura do QR Code
function onScanError(errorMessage) {
    console.warn(`Erro no scan: ${errorMessage}`);
}

// Fecha o modal e para os scanners ativos
document.querySelector('.close').addEventListener('click', () => {
    const modal = document.getElementById("modal");
    modal.style.display = "none";

    // Remove o mapa ao fechar o modal
    if (modalMap) {
        modalMap.remove();
        modalMap = null;
    }

    // Para a leitura do QR Code ao fechar o modal
    if (qrScanner) {
        qrScanner.clear();
        qrScanner = null;
    }
});

// Bot√£o para fechar apenas o scanner (sem fechar o modal)
document.getElementById("btn-fechar-qr").addEventListener("click", () => {
    if (qrScanner) {
        qrScanner.clear();
        qrScanner = null;
    }

    document.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const local = urlParams.get('local');
    if (local && !isNaN(local)) {
        // Lembrando que seu array √© 0-indexado, ent√£o subtraia 1
        abrirModal(local - 1);
    }
});

    
});
